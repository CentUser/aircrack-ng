From ff70494dd389ba570dbdbf36f217c28d4381c6b5 Mon Sep 17 00:00:00 2001
From: Thomas d'Otreppe <tdotreppe@aircrack-ng.org>
Date: Fri, 3 Oct 2014 01:51:21 +0000
Subject: [PATCH] Airodump-ng: Fixed GPS stack overflow (Closes #13 on GitHub).

git-svn-id: http://svn.aircrack-ng.org/trunk@2416 28c6078b-6c39-48e3-add9-af49d547ecab
---
 src/airodump-ng.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/airodump-ng.c b/src/airodump-ng.c
index 6cec912..222492c 100644
--- a/src/airodump-ng.c
+++ b/src/airodump-ng.c
@@ -4497,7 +4497,7 @@ void gps_tracker( void )
         	}
 
         	// New version, JSON
-        	if( recv( gpsd_sock, line + pos, sizeof( line ) - 1, 0 ) <= 0 )
+        	if( recv( gpsd_sock, line + pos, sizeof( line ) - pos - 1, 0 ) <= 0 )
         		return;
 
         	// search for TPV class: {"class":"TPV"
-- 
2.0.0.rc2

