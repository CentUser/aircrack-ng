From 091b153f294b9b695b0b2831e65936438b550d7b Mon Sep 17 00:00:00 2001
From: Thomas d'Otreppe <tdotreppe@aircrack-ng.org>
Date: Fri, 3 Oct 2014 01:53:50 +0000
Subject: [PATCH] Aireplay-ng: Fixed tcp_test stack overflow (Closes #14 on
 GitHub).

git-svn-id: http://svn.aircrack-ng.org/trunk@2417 28c6078b-6c39-48e3-add9-af49d547ecab
---
 src/aireplay-ng.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/aireplay-ng.c b/src/aireplay-ng.c
index 7335442..b397015 100644
--- a/src/aireplay-ng.c
+++ b/src/aireplay-ng.c
@@ -5398,6 +5398,8 @@ int tcp_test(const char* ip_str, const short port)
         if( (unsigned)caplen == sizeof(nh))
         {
             len = ntohl(nh.nh_len);
+            if (len > 1024 || len < 0)
+                continue;
             if( nh.nh_type == 1 && i==0 )
             {
                 i=1;
-- 
2.0.0.rc2

